{
  "hash": "82ce9723190221597e057e75b5d9a51a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Econometrics - Lecture 5\"\nsubtitle: \"Multiple Linear Regression\"\nauthor: \"Logan Kelly, Ph.D.\"\ndate: \"January 28, 2025\"\n---\n\n\n\n## Introduction\n\n- In this lecture, we extend the simple linear regression framework to include multiple predictors.\n- This approach allows us to understand the impact of each independent variable on the dependent variable while controlling for other factors.\n- By adding more predictors, we can better capture the complexity of real-world relationships and reduce omitted variable bias.\n\n## Key Concepts\n\n- Adding More Predictors\n- Partial Effects (Controlling for Other Variables)\n- Interpretation Nuances (Coefficients in Multiple Regression)\n- Model Selection & Fit Criteria\n\n## Theoretical Discussion\n\nA multiple linear regression model with two predictors can be written as:\n\n$$\ny = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\dots + \\varepsilon\n$$\n\n- $y$: The dependent variable  \n- $x_1, x_2, \\dots$: Independent variables (predictors)  \n- $\\beta_0$: The intercept, representing the expected value of $y$ when all predictors are zero  \n- $\\beta_1, \\beta_2, \\dots$: Slope coefficients, each indicating how $y$ changes with a one-unit increase in the corresponding predictor, holding other variables constant  \n- $\\varepsilon$: The error term, assumed to have a mean of zero if the model is correctly specified\n\n### Partial Effects and Controlling for Other Variables\n\n- Partial Effect: In a multiple regression, $\\beta_1$ represents the expected change in $y$ for a one-unit increase in $x_1$, holding $x_2, x_3, \\dots$ constant.  \n- Mathematically, each coefficient is the change in y divided by the chnge in $x_j$, i.e. $$\\beta_j = \\frac{\\partial y}{\\partial x_j}$$  \n- Importance of Controlling: By including additional predictors, we can isolate the effect of each variable and reduce omitted variable bias.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-2a39813d9fea7885ab3a\" style=\"width:100%;height:812px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2a39813d9fea7885ab3a\">{\"x\":{\"visdat\":{\"10da74dff6216\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"10da74dff6216\",\"attrs\":{\"10da74dff6216\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"showlegend\":false,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"},\"10da74dff6216.1\":{\"x\":{},\"y\":{},\"z\":[[29.707918960116547,29.397858822325116,29.087798684533681,28.777738546742249,28.467678408950814,28.157618271159382,27.847558133367947,27.537497995576516,27.22743785778508,26.917377719993649,26.607317582202214,26.297257444410782,25.98719730661935,25.677137168827915,25.367077031036484,25.057016893245049,24.746956755453617,24.436896617662182,24.12683647987075,23.816776342079319,23.506716204287883,23.196656066496452,22.886595928705017,22.576535790913585,22.266475653122153,21.956415515330718,21.646355377539287,21.336295239747852,21.02623510195642,20.716174964164985],[29.184946683097763,28.874886545306332,28.564826407514897,28.254766269723465,27.94470613193203,27.634645994140598,27.324585856349163,27.014525718557731,26.704465580766296,26.394405442974865,26.08434530518343,25.774285167391998,25.464225029600566,25.154164891809131,24.8441047540177,24.534044616226264,24.223984478434833,23.913924340643398,23.603864202851966,23.293804065060534,22.983743927269099,22.673683789477668,22.363623651686233,22.053563513894801,21.743503376103369,21.433443238311934,21.123383100520503,20.813322962729067,20.503262824937636,20.193202687146201],[28.661974406078979,28.351914268287548,28.041854130496112,27.731793992704681,27.421733854913246,27.111673717121814,26.801613579330379,26.491553441538947,26.181493303747512,25.871433165956081,25.561373028164645,25.251312890373214,24.941252752581782,24.631192614790347,24.321132476998915,24.01107233920748,23.701012201416049,23.390952063624614,23.080891925833182,22.77083178804175,22.460771650250315,22.150711512458884,21.840651374667448,21.530591236876017,21.220531099084585,20.91047096129315,20.600410823501718,20.290350685710283,19.980290547918852,19.670230410127417],[28.139002129060195,27.828941991268763,27.518881853477328,27.208821715685897,26.898761577894462,26.58870144010303,26.278641302311595,25.968581164520163,25.658521026728728,25.348460888937296,25.038400751145861,24.72834061335443,24.418280475562998,24.108220337771563,23.798160199980131,23.488100062188696,23.178039924397265,22.867979786605829,22.557919648814398,22.247859511022966,21.937799373231531,21.627739235440099,21.317679097648664,21.007618959857233,20.697558822065801,20.387498684274366,20.077438546482934,19.767378408691499,19.457318270900068,19.147258133108632],[27.616029852041414,27.305969714249983,26.995909576458548,26.685849438667116,26.375789300875681,26.065729163084249,25.755669025292814,25.445608887501383,25.135548749709947,24.825488611918516,24.515428474127081,24.205368336335649,23.895308198544218,23.585248060752782,23.275187922961351,22.965127785169916,22.655067647378484,22.345007509587049,22.034947371795617,21.724887234004186,21.41482709621275,21.104766958421319,20.794706820629884,20.484646682838452,20.174586545047021,19.864526407255585,19.554466269464154,19.244406131672719,18.934345993881287,18.624285856089852],[27.09305757502263,26.782997437231199,26.472937299439764,26.162877161648332,25.852817023856897,25.542756886065465,25.23269674827403,24.922636610482598,24.612576472691163,24.302516334899732,23.992456197108297,23.682396059316865,23.372335921525433,23.062275783733998,22.752215645942567,22.442155508151131,22.1320953703597,21.822035232568265,21.511975094776833,21.201914956985402,20.891854819193966,20.581794681402535,20.2717345436111,19.961674405819668,19.651614268028236,19.341554130236801,19.03149399244537,18.721433854653935,18.411373716862503,18.101313579071068],[26.570085298003846,26.260025160212415,25.949965022420979,25.639904884629548,25.329844746838113,25.019784609046681,24.709724471255246,24.399664333463814,24.089604195672379,23.779544057880948,23.469483920089512,23.159423782298081,22.849363644506649,22.539303506715214,22.229243368923782,21.919183231132347,21.609123093340916,21.299062955549481,20.989002817758049,20.678942679966617,20.368882542175182,20.058822404383751,19.748762266592315,19.438702128800884,19.128641991009452,18.818581853218017,18.508521715426586,18.19846157763515,17.888401439843719,17.578341302052284],[26.047113020985062,25.73705288319363,25.426992745402195,25.116932607610764,24.806872469819329,24.496812332027897,24.186752194236462,23.87669205644503,23.566631918653595,23.256571780862163,22.946511643070728,22.636451505279297,22.326391367487865,22.01633122969643,21.706271091904998,21.396210954113563,21.086150816322132,20.776090678530696,20.466030540739265,20.155970402947833,19.845910265156398,19.535850127364967,19.225789989573531,18.9157298517821,18.605669713990668,18.295609576199233,17.985549438407801,17.675489300616366,17.365429162824935,17.055369025033499],[25.524140743966282,25.21408060617485,24.904020468383415,24.593960330591983,24.283900192800548,23.973840055009116,23.663779917217681,23.35371977942625,23.043659641634815,22.733599503843383,22.423539366051948,22.113479228260516,21.803419090469085,21.493358952677649,21.183298814886218,20.873238677094783,20.563178539303351,20.253118401511916,19.943058263720484,19.632998125929053,19.322937988137618,19.012877850346186,18.702817712554751,18.392757574763319,18.082697436971888,17.772637299180452,17.462577161389021,17.152517023597586,16.842456885806154,16.532396748014719],[25.001168466947497,24.691108329156066,24.381048191364631,24.070988053573199,23.760927915781764,23.450867777990332,23.140807640198897,22.830747502407466,22.52068736461603,22.210627226824599,21.900567089033164,21.590506951241732,21.2804468134503,20.970386675658865,20.660326537867434,20.350266400075999,20.040206262284567,19.730146124493132,19.4200859867017,19.110025848910269,18.799965711118833,18.489905573327402,18.179845435535967,17.869785297744535,17.559725159953103,17.249665022161668,16.939604884370237,16.629544746578802,16.31948460878737,16.009424470995935],[24.478196189928713,24.168136052137282,23.858075914345847,23.548015776554415,23.23795563876298,22.927895500971548,22.617835363180113,22.307775225388681,21.997715087597246,21.687654949805815,21.377594812014379,21.067534674222948,20.757474536431516,20.447414398640081,20.13735426084865,19.827294123057214,19.517233985265783,19.207173847474348,18.897113709682916,18.587053571891484,18.276993434100049,17.966933296308618,17.656873158517183,17.346813020725751,17.036752882934319,16.726692745142884,16.416632607351453,16.106572469560017,15.796512331768584,15.486452193977152],[23.955223912909929,23.645163775118498,23.335103637327062,23.025043499535631,22.714983361744196,22.404923223952764,22.094863086161329,21.784802948369897,21.474742810578462,21.164682672787031,20.854622534995595,20.544562397204164,20.234502259412732,19.924442121621297,19.614381983829865,19.30432184603843,18.994261708246999,18.684201570455564,18.374141432664132,18.0640812948727,17.754021157081265,17.443961019289834,17.133900881498398,16.823840743706967,16.513780605915535,16.2037204681241,15.893660330332667,15.583600192541233,15.2735400547498,14.963479916958368],[23.432251635891149,23.122191498099717,22.812131360308282,22.50207122251685,22.192011084725415,21.881950946933983,21.571890809142548,21.261830671351117,20.951770533559682,20.64171039576825,20.331650257976815,20.021590120185383,19.711529982393952,19.401469844602516,19.091409706811085,18.78134956901965,18.471289431228218,18.161229293436783,17.851169155645351,17.54110901785392,17.231048880062485,16.920988742271053,16.610928604479618,16.300868466688186,15.990808328896753,15.680748191105319,15.370688053313886,15.060627915522453,14.750567777731019,14.440507639939588],[22.909279358872364,22.599219221080933,22.289159083289498,21.979098945498066,21.669038807706631,21.358978669915199,21.048918532123764,20.738858394332333,20.428798256540897,20.118738118749466,19.808677980958031,19.498617843166599,19.188557705375167,18.878497567583732,18.568437429792301,18.258377292000866,17.948317154209434,17.638257016417999,17.328196878626567,17.018136740835136,16.7080766030437,16.398016465252269,16.087956327460834,15.777896189669402,15.467836051877969,15.157775914086535,14.847715776295102,14.537655638503669,14.227595500712235,13.917535362920804],[22.38630708185358,22.076246944062149,21.766186806270714,21.456126668479282,21.146066530687847,20.836006392896415,20.52594625510498,20.215886117313548,19.905825979522113,19.595765841730682,19.285705703939247,18.975645566147815,18.665585428356383,18.355525290564948,18.045465152773517,17.735405014982081,17.42534487719065,17.115284739399215,16.805224601607783,16.495164463816351,16.185104326024916,15.875044188233485,15.56498405044205,15.254923912650618,14.944863774859185,14.634803637067751,14.324743499276318,14.014683361484884,13.704623223693451,13.394563085902019],[21.8633348048348,21.553274667043368,21.243214529251933,20.933154391460501,20.623094253669066,20.313034115877635,20.002973978086199,19.692913840294768,19.382853702503333,19.072793564711901,18.762733426920466,18.452673289129034,18.142613151337603,17.832553013546168,17.522492875754736,17.212432737963301,16.902372600171869,16.592312462380434,16.282252324589003,15.972192186797569,15.662132049006136,15.352071911214704,15.042011773423269,14.731951635631837,14.421891497840404,14.111831360048971,13.801771222257537,13.491711084466104,13.181650946674671,12.871590808883239],[21.340362527816016,21.030302390024584,20.720242252233149,20.410182114441717,20.100121976650282,19.790061838858851,19.480001701067415,19.169941563275984,18.859881425484549,18.549821287693117,18.239761149901682,17.92970101211025,17.619640874318819,17.309580736527383,16.999520598735952,16.689460460944517,16.379400323153085,16.06934018536165,15.759280047570218,15.449219909778785,15.139159771987352,14.82909963419592,14.519039496404485,14.208979358613053,13.89891922082162,13.588859083030187,13.278798945238753,12.96873880744732,12.658678669655886,12.348618531864455],[20.817390250797231,20.5073301130058,20.197269975214365,19.887209837422933,19.577149699631498,19.267089561840066,18.957029424048631,18.6469692862572,18.336909148465764,18.026849010674333,17.716788872882898,17.406728735091466,17.096668597300035,16.786608459508599,16.476548321717168,16.166488183925733,15.856428046134301,15.546367908342868,15.236307770551434,14.926247632760001,14.616187494968568,14.306127357177136,13.996067219385701,13.686007081594269,13.375946943802836,13.065886806011402,12.755826668219969,12.445766530428536,12.135706392637102,11.825646254845671],[20.294417973778447,19.984357835987016,19.674297698195581,19.364237560404149,19.054177422612714,18.744117284821282,18.434057147029847,18.123997009238416,17.81393687144698,17.503876733655549,17.193816595864114,16.883756458072682,16.57369632028125,16.263636182489815,15.953576044698384,15.64351590690695,15.333455769115517,15.023395631324084,14.71333549353265,14.403275355741217,14.093215217949783,13.783155080158352,13.473094942366917,13.163034804575485,12.852974666784052,12.542914528992618,12.232854391201185,11.922794253409752,11.612734115618318,11.302673977826887],[19.771445696759667,19.461385558968235,19.1513254211768,18.841265283385368,18.531205145593933,18.221145007802502,17.911084870011067,17.601024732219635,17.2909645944282,16.980904456636768,16.670844318845333,16.360784181053901,16.05072404326247,15.740663905471036,15.430603767679603,15.12054362988817,14.810483492096736,14.500423354305303,14.19036321651387,13.880303078722436,13.570242940931003,13.260182803139571,12.950122665348136,12.640062527556704,12.330002389765271,12.019942251973838,11.709882114182404,11.399821976390971,11.089761838599538,10.779701700808106],[19.248473419740883,18.938413281949451,18.628353144158016,18.318293006366584,18.008232868575149,17.698172730783718,17.388112592992282,17.078052455200851,16.767992317409416,16.457932179617984,16.147872041826549,15.837811904035117,15.527751766243686,15.217691628452252,14.907631490660819,14.597571352869386,14.287511215077952,13.977451077286519,13.667390939495085,13.357330801703652,13.047270663912219,12.737210526120787,12.427150388329352,12.11709025053792,11.807030112746487,11.496969974955054,11.18690983716362,10.876849699372187,10.566789561580753,10.256729423789322],[18.725501142722099,18.415441004930667,18.105380867139232,17.7953207293478,17.485260591556365,17.175200453764933,16.865140315973498,16.555080178182067,16.245020040390632,15.9349599025992,15.624899764807767,15.314839627016333,15.004779489224902,14.694719351433468,14.384659213642035,14.074599075850601,13.764538938059168,13.454478800267735,13.144418662476301,12.834358524684868,12.524298386893435,12.214238249102003,11.904178111310568,11.594117973519136,11.284057835727703,10.973997697936269,10.663937560144836,10.353877422353403,10.043817284561969,9.7337571467705377],[18.202528865703314,17.892468727911883,17.582408590120448,17.272348452329016,16.962288314537581,16.652228176746149,16.342168038954714,16.032107901163283,15.722047763371849,15.411987625580416,15.101927487788982,14.791867349997549,14.481807212206117,14.171747074414684,13.861686936623251,13.551626798831817,13.241566661040384,12.931506523248951,12.621446385457517,12.311386247666084,12.00132610987465,11.691265972083219,11.381205834291784,11.071145696500352,10.761085558708919,10.451025420917485,10.140965283126052,9.8309051453346186,9.5208450075431852,9.2107848697517536],[17.679556588684534,17.369496450893102,17.059436313101667,16.749376175310235,16.4393160375188,16.129255899727369,15.819195761935935,15.509135624144502,15.199075486353069,14.889015348561635,14.578955210770202,14.268895072978768,13.958834935187337,13.648774797395903,13.33871465960447,13.028654521813037,12.718594384021603,12.40853424623017,12.098474108438737,11.788413970647303,11.47835383285587,11.168293695064438,10.858233557273003,10.548173419481572,10.238113281690138,9.9280531438987047,9.6179930061072714,9.307932868315838,8.9978727305244046,8.687812592732973],[17.15658431166575,16.846524173874318,16.536464036082883,16.226403898291451,15.916343760500016,15.606283622708583,15.296223484917151,14.986163347125718,14.676103209334284,14.366043071542851,14.055982933751418,13.745922795959984,13.435862658168553,13.125802520377119,12.815742382585686,12.505682244794253,12.195622107002819,11.885561969211386,11.575501831419952,11.265441693628519,10.955381555837086,10.645321418045654,10.335261280254219,10.025201142462787,9.715141004671354,9.4050808668799206,9.0950207290884872,8.7849605912970539,8.4749004535056205,8.1648403157141889],[16.633612034646966,16.323551896855534,16.013491759064099,15.703431621272665,15.393371483481232,15.083311345689799,14.773251207898367,14.463191070106934,14.1531309323155,13.843070794524067,13.533010656732634,13.2229505189412,12.912890381149769,12.602830243358335,12.292770105566902,11.982709967775468,11.672649829984035,11.362589692192602,11.052529554401168,10.742469416609735,10.432409278818302,10.12234914102687,9.8122890032354348,9.5022288654440032,9.1921687276525699,8.8821085898611365,8.5720484520697031,8.2619883142782697,7.9519281764868373,7.6418680386954039],[16.110639757628185,15.800579619836752,15.490519482045318,15.180459344253885,14.870399206462452,14.560339068671018,14.250278930879587,13.940218793088153,13.63015865529672,13.320098517505286,13.010038379713853,12.69997824192242,12.389918104130988,12.079857966339555,11.769797828548121,11.459737690756688,11.149677552965255,10.839617415173821,10.529557277382388,10.219497139590954,9.909437001799521,9.5993768640080894,9.2893167262166543,8.9792565884252227,8.6691964506337893,8.3591363128423559,8.0490761750509225,7.7390160372594901,7.4289558994680567,7.1188957616766233],[15.587667480609401,15.277607342817968,14.967547205026534,14.657487067235101,14.347426929443667,14.037366791652234,13.727306653860802,13.417246516069369,13.107186378277936,12.797126240486502,12.487066102695069,12.177005964903636,11.866945827112204,11.556885689320771,11.246825551529337,10.936765413737904,10.62670527594647,10.316645138155037,10.006585000363604,9.6965248625721703,9.3864647247807369,9.0764045869893053,8.7663444491978701,8.4562843114064385,8.1462241736150052,7.8361640358235718,7.5261038980321393,7.2160437602407059,6.9059836224492726,6.5959234846578392],[15.064695203590613,14.75463506579918,14.444574928007746,14.134514790216313,13.82445465242488,13.514394514633446,13.204334376842015,12.894274239050581,12.584214101259148,12.274153963467715,11.964093825676281,11.654033687884848,11.343973550093416,11.033913412301983,10.723853274510549,10.413793136719116,10.103732998927683,9.7936728611362494,9.483612723344816,9.1735525855533826,8.8634924477619492,8.5534323099705176,8.2433721721790825,7.9333120343876509,7.6232518965962175,7.3131917588047841,7.0031316210133516,6.6930714832219182,6.3830113454304849,6.0729512076390515],[14.541722926571833,14.231662788780399,13.921602650988966,13.611542513197533,13.301482375406099,12.991422237614666,12.681362099823234,12.371301962031801,12.061241824240367,11.751181686448934,11.441121548657501,11.131061410866067,10.821001273074636,10.510941135283202,10.200880997491769,9.8908208597003355,9.5807607219089022,9.2707005841174688,8.9606404463260354,8.650580308534602,8.3405201707431686,8.030460032951737,7.7203998951603019,7.4103397573688703,7.1002796195774369,6.7902194817860035,6.4801593439945711,6.1700992062031377,5.8600390684117043,5.5499789306202709]],\"mode\":\"markers\",\"showlegend\":false,\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"surface\",\"showscale\":false,\"opacity\":0.5,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":0,\"l\":0,\"t\":0,\"r\":0},\"scene\":{\"xaxis\":{\"title\":\"Weight\"},\"yaxis\":{\"title\":\"Horsepower\"},\"zaxis\":{\"title\":\"Miles per Gallon\"},\"camera\":{\"eye\":{\"x\":2,\"y\":2,\"z\":2}}},\"showlegend\":false,\"hovermode\":\"closest\"},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"displayModeBar\":false},\"data\":[{\"x\":[2.6200000000000001,2.875,2.3199999999999998,3.2149999999999999,3.4399999999999999,3.46,3.5699999999999998,3.1899999999999999,3.1499999999999999,3.4399999999999999,3.4399999999999999,4.0700000000000003,3.73,3.7799999999999998,5.25,5.4240000000000004,5.3449999999999998,2.2000000000000002,1.615,1.835,2.4649999999999999,3.52,3.4350000000000001,3.8399999999999999,3.8450000000000002,1.9350000000000001,2.1400000000000001,1.5129999999999999,3.1699999999999999,2.77,3.5699999999999998,2.7799999999999998],\"y\":[110,110,93,110,175,105,245,62,95,123,123,180,180,180,205,215,230,66,52,65,97,150,150,245,175,66,91,113,264,175,335,109],\"z\":[21,21,22.800000000000001,21.399999999999999,18.699999999999999,18.100000000000001,14.300000000000001,24.399999999999999,22.800000000000001,19.199999999999999,17.800000000000001,16.399999999999999,17.300000000000001,15.199999999999999,10.4,10.4,14.699999999999999,32.399999999999999,30.399999999999999,33.899999999999999,21.5,15.5,15.199999999999999,13.300000000000001,19.199999999999999,27.300000000000001,26,30.399999999999999,15.800000000000001,19.699999999999999,15,21.399999999999999],\"mode\":\"markers\",\"showlegend\":false,\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"line\":{\"color\":\"rgba(31,119,180,1)\"},\"frame\":null},{\"colorbar\":{\"title\":\"mpg\",\"ticklen\":2},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666667\",\"rgba(70,19,97,1)\"],[\"0.0833333333333333\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666667\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":false,\"x\":[1.5129999999999999,1.6478620689655172,1.7827241379310343,1.9175862068965517,2.0524482758620688,2.1873103448275861,2.3221724137931035,2.4570344827586208,2.5918965517241377,2.7267586206896555,2.8616206896551724,2.9964827586206897,3.131344827586207,3.2662068965517239,3.4010689655172417,3.5359310344827586,3.6707931034482759,3.8056551724137933,3.9405172413793106,4.075379310344827,4.2102413793103448,4.3451034482758626,4.4799655172413795,4.6148275862068964,4.7496896551724141,4.884551724137931,5.0194137931034479,5.1542758620689657,5.2891379310344835,5.4240000000000004],\"y\":[52,61.758620689655174,71.517241379310349,81.275862068965523,91.034482758620697,100.79310344827587,110.55172413793103,120.31034482758621,130.06896551724139,139.82758620689657,149.58620689655174,159.34482758620692,169.10344827586206,178.86206896551724,188.62068965517241,198.37931034482759,208.13793103448276,217.89655172413794,227.65517241379311,237.41379310344828,247.17241379310346,256.93103448275861,266.68965517241384,276.44827586206895,286.20689655172413,295.9655172413793,305.72413793103448,315.48275862068965,325.24137931034483,335],\"z\":[[29.707918960116547,29.397858822325116,29.087798684533681,28.777738546742249,28.467678408950814,28.157618271159382,27.847558133367947,27.537497995576516,27.22743785778508,26.917377719993649,26.607317582202214,26.297257444410782,25.98719730661935,25.677137168827915,25.367077031036484,25.057016893245049,24.746956755453617,24.436896617662182,24.12683647987075,23.816776342079319,23.506716204287883,23.196656066496452,22.886595928705017,22.576535790913585,22.266475653122153,21.956415515330718,21.646355377539287,21.336295239747852,21.02623510195642,20.716174964164985],[29.184946683097763,28.874886545306332,28.564826407514897,28.254766269723465,27.94470613193203,27.634645994140598,27.324585856349163,27.014525718557731,26.704465580766296,26.394405442974865,26.08434530518343,25.774285167391998,25.464225029600566,25.154164891809131,24.8441047540177,24.534044616226264,24.223984478434833,23.913924340643398,23.603864202851966,23.293804065060534,22.983743927269099,22.673683789477668,22.363623651686233,22.053563513894801,21.743503376103369,21.433443238311934,21.123383100520503,20.813322962729067,20.503262824937636,20.193202687146201],[28.661974406078979,28.351914268287548,28.041854130496112,27.731793992704681,27.421733854913246,27.111673717121814,26.801613579330379,26.491553441538947,26.181493303747512,25.871433165956081,25.561373028164645,25.251312890373214,24.941252752581782,24.631192614790347,24.321132476998915,24.01107233920748,23.701012201416049,23.390952063624614,23.080891925833182,22.77083178804175,22.460771650250315,22.150711512458884,21.840651374667448,21.530591236876017,21.220531099084585,20.91047096129315,20.600410823501718,20.290350685710283,19.980290547918852,19.670230410127417],[28.139002129060195,27.828941991268763,27.518881853477328,27.208821715685897,26.898761577894462,26.58870144010303,26.278641302311595,25.968581164520163,25.658521026728728,25.348460888937296,25.038400751145861,24.72834061335443,24.418280475562998,24.108220337771563,23.798160199980131,23.488100062188696,23.178039924397265,22.867979786605829,22.557919648814398,22.247859511022966,21.937799373231531,21.627739235440099,21.317679097648664,21.007618959857233,20.697558822065801,20.387498684274366,20.077438546482934,19.767378408691499,19.457318270900068,19.147258133108632],[27.616029852041414,27.305969714249983,26.995909576458548,26.685849438667116,26.375789300875681,26.065729163084249,25.755669025292814,25.445608887501383,25.135548749709947,24.825488611918516,24.515428474127081,24.205368336335649,23.895308198544218,23.585248060752782,23.275187922961351,22.965127785169916,22.655067647378484,22.345007509587049,22.034947371795617,21.724887234004186,21.41482709621275,21.104766958421319,20.794706820629884,20.484646682838452,20.174586545047021,19.864526407255585,19.554466269464154,19.244406131672719,18.934345993881287,18.624285856089852],[27.09305757502263,26.782997437231199,26.472937299439764,26.162877161648332,25.852817023856897,25.542756886065465,25.23269674827403,24.922636610482598,24.612576472691163,24.302516334899732,23.992456197108297,23.682396059316865,23.372335921525433,23.062275783733998,22.752215645942567,22.442155508151131,22.1320953703597,21.822035232568265,21.511975094776833,21.201914956985402,20.891854819193966,20.581794681402535,20.2717345436111,19.961674405819668,19.651614268028236,19.341554130236801,19.03149399244537,18.721433854653935,18.411373716862503,18.101313579071068],[26.570085298003846,26.260025160212415,25.949965022420979,25.639904884629548,25.329844746838113,25.019784609046681,24.709724471255246,24.399664333463814,24.089604195672379,23.779544057880948,23.469483920089512,23.159423782298081,22.849363644506649,22.539303506715214,22.229243368923782,21.919183231132347,21.609123093340916,21.299062955549481,20.989002817758049,20.678942679966617,20.368882542175182,20.058822404383751,19.748762266592315,19.438702128800884,19.128641991009452,18.818581853218017,18.508521715426586,18.19846157763515,17.888401439843719,17.578341302052284],[26.047113020985062,25.73705288319363,25.426992745402195,25.116932607610764,24.806872469819329,24.496812332027897,24.186752194236462,23.87669205644503,23.566631918653595,23.256571780862163,22.946511643070728,22.636451505279297,22.326391367487865,22.01633122969643,21.706271091904998,21.396210954113563,21.086150816322132,20.776090678530696,20.466030540739265,20.155970402947833,19.845910265156398,19.535850127364967,19.225789989573531,18.9157298517821,18.605669713990668,18.295609576199233,17.985549438407801,17.675489300616366,17.365429162824935,17.055369025033499],[25.524140743966282,25.21408060617485,24.904020468383415,24.593960330591983,24.283900192800548,23.973840055009116,23.663779917217681,23.35371977942625,23.043659641634815,22.733599503843383,22.423539366051948,22.113479228260516,21.803419090469085,21.493358952677649,21.183298814886218,20.873238677094783,20.563178539303351,20.253118401511916,19.943058263720484,19.632998125929053,19.322937988137618,19.012877850346186,18.702817712554751,18.392757574763319,18.082697436971888,17.772637299180452,17.462577161389021,17.152517023597586,16.842456885806154,16.532396748014719],[25.001168466947497,24.691108329156066,24.381048191364631,24.070988053573199,23.760927915781764,23.450867777990332,23.140807640198897,22.830747502407466,22.52068736461603,22.210627226824599,21.900567089033164,21.590506951241732,21.2804468134503,20.970386675658865,20.660326537867434,20.350266400075999,20.040206262284567,19.730146124493132,19.4200859867017,19.110025848910269,18.799965711118833,18.489905573327402,18.179845435535967,17.869785297744535,17.559725159953103,17.249665022161668,16.939604884370237,16.629544746578802,16.31948460878737,16.009424470995935],[24.478196189928713,24.168136052137282,23.858075914345847,23.548015776554415,23.23795563876298,22.927895500971548,22.617835363180113,22.307775225388681,21.997715087597246,21.687654949805815,21.377594812014379,21.067534674222948,20.757474536431516,20.447414398640081,20.13735426084865,19.827294123057214,19.517233985265783,19.207173847474348,18.897113709682916,18.587053571891484,18.276993434100049,17.966933296308618,17.656873158517183,17.346813020725751,17.036752882934319,16.726692745142884,16.416632607351453,16.106572469560017,15.796512331768584,15.486452193977152],[23.955223912909929,23.645163775118498,23.335103637327062,23.025043499535631,22.714983361744196,22.404923223952764,22.094863086161329,21.784802948369897,21.474742810578462,21.164682672787031,20.854622534995595,20.544562397204164,20.234502259412732,19.924442121621297,19.614381983829865,19.30432184603843,18.994261708246999,18.684201570455564,18.374141432664132,18.0640812948727,17.754021157081265,17.443961019289834,17.133900881498398,16.823840743706967,16.513780605915535,16.2037204681241,15.893660330332667,15.583600192541233,15.2735400547498,14.963479916958368],[23.432251635891149,23.122191498099717,22.812131360308282,22.50207122251685,22.192011084725415,21.881950946933983,21.571890809142548,21.261830671351117,20.951770533559682,20.64171039576825,20.331650257976815,20.021590120185383,19.711529982393952,19.401469844602516,19.091409706811085,18.78134956901965,18.471289431228218,18.161229293436783,17.851169155645351,17.54110901785392,17.231048880062485,16.920988742271053,16.610928604479618,16.300868466688186,15.990808328896753,15.680748191105319,15.370688053313886,15.060627915522453,14.750567777731019,14.440507639939588],[22.909279358872364,22.599219221080933,22.289159083289498,21.979098945498066,21.669038807706631,21.358978669915199,21.048918532123764,20.738858394332333,20.428798256540897,20.118738118749466,19.808677980958031,19.498617843166599,19.188557705375167,18.878497567583732,18.568437429792301,18.258377292000866,17.948317154209434,17.638257016417999,17.328196878626567,17.018136740835136,16.7080766030437,16.398016465252269,16.087956327460834,15.777896189669402,15.467836051877969,15.157775914086535,14.847715776295102,14.537655638503669,14.227595500712235,13.917535362920804],[22.38630708185358,22.076246944062149,21.766186806270714,21.456126668479282,21.146066530687847,20.836006392896415,20.52594625510498,20.215886117313548,19.905825979522113,19.595765841730682,19.285705703939247,18.975645566147815,18.665585428356383,18.355525290564948,18.045465152773517,17.735405014982081,17.42534487719065,17.115284739399215,16.805224601607783,16.495164463816351,16.185104326024916,15.875044188233485,15.56498405044205,15.254923912650618,14.944863774859185,14.634803637067751,14.324743499276318,14.014683361484884,13.704623223693451,13.394563085902019],[21.8633348048348,21.553274667043368,21.243214529251933,20.933154391460501,20.623094253669066,20.313034115877635,20.002973978086199,19.692913840294768,19.382853702503333,19.072793564711901,18.762733426920466,18.452673289129034,18.142613151337603,17.832553013546168,17.522492875754736,17.212432737963301,16.902372600171869,16.592312462380434,16.282252324589003,15.972192186797569,15.662132049006136,15.352071911214704,15.042011773423269,14.731951635631837,14.421891497840404,14.111831360048971,13.801771222257537,13.491711084466104,13.181650946674671,12.871590808883239],[21.340362527816016,21.030302390024584,20.720242252233149,20.410182114441717,20.100121976650282,19.790061838858851,19.480001701067415,19.169941563275984,18.859881425484549,18.549821287693117,18.239761149901682,17.92970101211025,17.619640874318819,17.309580736527383,16.999520598735952,16.689460460944517,16.379400323153085,16.06934018536165,15.759280047570218,15.449219909778785,15.139159771987352,14.82909963419592,14.519039496404485,14.208979358613053,13.89891922082162,13.588859083030187,13.278798945238753,12.96873880744732,12.658678669655886,12.348618531864455],[20.817390250797231,20.5073301130058,20.197269975214365,19.887209837422933,19.577149699631498,19.267089561840066,18.957029424048631,18.6469692862572,18.336909148465764,18.026849010674333,17.716788872882898,17.406728735091466,17.096668597300035,16.786608459508599,16.476548321717168,16.166488183925733,15.856428046134301,15.546367908342868,15.236307770551434,14.926247632760001,14.616187494968568,14.306127357177136,13.996067219385701,13.686007081594269,13.375946943802836,13.065886806011402,12.755826668219969,12.445766530428536,12.135706392637102,11.825646254845671],[20.294417973778447,19.984357835987016,19.674297698195581,19.364237560404149,19.054177422612714,18.744117284821282,18.434057147029847,18.123997009238416,17.81393687144698,17.503876733655549,17.193816595864114,16.883756458072682,16.57369632028125,16.263636182489815,15.953576044698384,15.64351590690695,15.333455769115517,15.023395631324084,14.71333549353265,14.403275355741217,14.093215217949783,13.783155080158352,13.473094942366917,13.163034804575485,12.852974666784052,12.542914528992618,12.232854391201185,11.922794253409752,11.612734115618318,11.302673977826887],[19.771445696759667,19.461385558968235,19.1513254211768,18.841265283385368,18.531205145593933,18.221145007802502,17.911084870011067,17.601024732219635,17.2909645944282,16.980904456636768,16.670844318845333,16.360784181053901,16.05072404326247,15.740663905471036,15.430603767679603,15.12054362988817,14.810483492096736,14.500423354305303,14.19036321651387,13.880303078722436,13.570242940931003,13.260182803139571,12.950122665348136,12.640062527556704,12.330002389765271,12.019942251973838,11.709882114182404,11.399821976390971,11.089761838599538,10.779701700808106],[19.248473419740883,18.938413281949451,18.628353144158016,18.318293006366584,18.008232868575149,17.698172730783718,17.388112592992282,17.078052455200851,16.767992317409416,16.457932179617984,16.147872041826549,15.837811904035117,15.527751766243686,15.217691628452252,14.907631490660819,14.597571352869386,14.287511215077952,13.977451077286519,13.667390939495085,13.357330801703652,13.047270663912219,12.737210526120787,12.427150388329352,12.11709025053792,11.807030112746487,11.496969974955054,11.18690983716362,10.876849699372187,10.566789561580753,10.256729423789322],[18.725501142722099,18.415441004930667,18.105380867139232,17.7953207293478,17.485260591556365,17.175200453764933,16.865140315973498,16.555080178182067,16.245020040390632,15.9349599025992,15.624899764807767,15.314839627016333,15.004779489224902,14.694719351433468,14.384659213642035,14.074599075850601,13.764538938059168,13.454478800267735,13.144418662476301,12.834358524684868,12.524298386893435,12.214238249102003,11.904178111310568,11.594117973519136,11.284057835727703,10.973997697936269,10.663937560144836,10.353877422353403,10.043817284561969,9.7337571467705377],[18.202528865703314,17.892468727911883,17.582408590120448,17.272348452329016,16.962288314537581,16.652228176746149,16.342168038954714,16.032107901163283,15.722047763371849,15.411987625580416,15.101927487788982,14.791867349997549,14.481807212206117,14.171747074414684,13.861686936623251,13.551626798831817,13.241566661040384,12.931506523248951,12.621446385457517,12.311386247666084,12.00132610987465,11.691265972083219,11.381205834291784,11.071145696500352,10.761085558708919,10.451025420917485,10.140965283126052,9.8309051453346186,9.5208450075431852,9.2107848697517536],[17.679556588684534,17.369496450893102,17.059436313101667,16.749376175310235,16.4393160375188,16.129255899727369,15.819195761935935,15.509135624144502,15.199075486353069,14.889015348561635,14.578955210770202,14.268895072978768,13.958834935187337,13.648774797395903,13.33871465960447,13.028654521813037,12.718594384021603,12.40853424623017,12.098474108438737,11.788413970647303,11.47835383285587,11.168293695064438,10.858233557273003,10.548173419481572,10.238113281690138,9.9280531438987047,9.6179930061072714,9.307932868315838,8.9978727305244046,8.687812592732973],[17.15658431166575,16.846524173874318,16.536464036082883,16.226403898291451,15.916343760500016,15.606283622708583,15.296223484917151,14.986163347125718,14.676103209334284,14.366043071542851,14.055982933751418,13.745922795959984,13.435862658168553,13.125802520377119,12.815742382585686,12.505682244794253,12.195622107002819,11.885561969211386,11.575501831419952,11.265441693628519,10.955381555837086,10.645321418045654,10.335261280254219,10.025201142462787,9.715141004671354,9.4050808668799206,9.0950207290884872,8.7849605912970539,8.4749004535056205,8.1648403157141889],[16.633612034646966,16.323551896855534,16.013491759064099,15.703431621272665,15.393371483481232,15.083311345689799,14.773251207898367,14.463191070106934,14.1531309323155,13.843070794524067,13.533010656732634,13.2229505189412,12.912890381149769,12.602830243358335,12.292770105566902,11.982709967775468,11.672649829984035,11.362589692192602,11.052529554401168,10.742469416609735,10.432409278818302,10.12234914102687,9.8122890032354348,9.5022288654440032,9.1921687276525699,8.8821085898611365,8.5720484520697031,8.2619883142782697,7.9519281764868373,7.6418680386954039],[16.110639757628185,15.800579619836752,15.490519482045318,15.180459344253885,14.870399206462452,14.560339068671018,14.250278930879587,13.940218793088153,13.63015865529672,13.320098517505286,13.010038379713853,12.69997824192242,12.389918104130988,12.079857966339555,11.769797828548121,11.459737690756688,11.149677552965255,10.839617415173821,10.529557277382388,10.219497139590954,9.909437001799521,9.5993768640080894,9.2893167262166543,8.9792565884252227,8.6691964506337893,8.3591363128423559,8.0490761750509225,7.7390160372594901,7.4289558994680567,7.1188957616766233],[15.587667480609401,15.277607342817968,14.967547205026534,14.657487067235101,14.347426929443667,14.037366791652234,13.727306653860802,13.417246516069369,13.107186378277936,12.797126240486502,12.487066102695069,12.177005964903636,11.866945827112204,11.556885689320771,11.246825551529337,10.936765413737904,10.62670527594647,10.316645138155037,10.006585000363604,9.6965248625721703,9.3864647247807369,9.0764045869893053,8.7663444491978701,8.4562843114064385,8.1462241736150052,7.8361640358235718,7.5261038980321393,7.2160437602407059,6.9059836224492726,6.5959234846578392],[15.064695203590613,14.75463506579918,14.444574928007746,14.134514790216313,13.82445465242488,13.514394514633446,13.204334376842015,12.894274239050581,12.584214101259148,12.274153963467715,11.964093825676281,11.654033687884848,11.343973550093416,11.033913412301983,10.723853274510549,10.413793136719116,10.103732998927683,9.7936728611362494,9.483612723344816,9.1735525855533826,8.8634924477619492,8.5534323099705176,8.2433721721790825,7.9333120343876509,7.6232518965962175,7.3131917588047841,7.0031316210133516,6.6930714832219182,6.3830113454304849,6.0729512076390515],[14.541722926571833,14.231662788780399,13.921602650988966,13.611542513197533,13.301482375406099,12.991422237614666,12.681362099823234,12.371301962031801,12.061241824240367,11.751181686448934,11.441121548657501,11.131061410866067,10.821001273074636,10.510941135283202,10.200880997491769,9.8908208597003355,9.5807607219089022,9.2707005841174688,8.9606404463260354,8.650580308534602,8.3405201707431686,8.030460032951737,7.7203998951603019,7.4103397573688703,7.1002796195774369,6.7902194817860035,6.4801593439945711,6.1700992062031377,5.8600390684117043,5.5499789306202709]],\"mode\":\"markers\",\"showlegend\":false,\"type\":\"surface\",\"opacity\":0.5,\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### Interpretation Nuances\n\n- Coefficient Magnitude: Each $\\beta_j$ shows how $y$ changes with $x_j$, keeping other predictors fixed.  \n- Significance and p-values: Determine if $\\beta_j$ is significantly different from zero.  \n- Multicollinearity: Highly correlated predictors can inflate standard errors, complicating interpretation.  \n- Model Fit: Metrics like Adjusted R-squared become more relevant when comparing models with different numbers of predictors.\n\nModel selection involves determining which predictors to include in a multiple regression model, balancing model performance with interpretability. Below is an overview of common techniques and considerations for selecting and evaluating models.\n\n### Forward, Backward, Stepwise Selection\n\n- Forward. Begin with no predictors, adding them one at a time based on a selection criterion (for instance, a p-value threshold or an information criterion).  \n- Backward. Start with all candidate predictors, removing them one at a time, typically removing the least significant predictor at each step.  \n- Stepwise. Combine forward and backward methods by iteratively adding or removing predictors, attempting to find an optimal subset.\n\n### Pro's and Con's\n\n- Pros of these approaches include the automated narrowing of large predictor sets. \n- However, can be sensitive to the order in which variables enter or leave the model\n- potentially result in overfitting.\n\n### Model Selection & Fit Criteria\n\nModel selection involves determining which predictors to include in a multiple regression model, balancing model performance with interpretability. Below is an overview of common techniques and considerations for selecting and evaluating models.\n\n- Forward, Backward, Stepwise Selection\n\n  - Forward: Begin with no predictors, adding them one at a time based on a selection criterion such as a p-value threshold or an information criterion like AIC.\n  \n  - Backward: Start with all candidate predictors, removing them one at a time, typically removing the least significant predictor at each step.\n  \n  - Stepwise: Combine forward and backward methods by iteratively adding or removing predictors, attempting to find an optimal subset.\n  \n  - **Pros:** Automated procedure, helps narrow down large sets of predictors.\n  \n  - **Cons:** Can overlook important predictors or retain irrelevant ones, sensitive to the order of entry or removal, may lead to overfitting.\n\n- AIC and BIC (Information Criteria)\n\n  Information criteria provide a way to compare model fit while penalizing excessive complexity. They are based on the log-likelihood function of the model.\n\n  The **Log-Likelihood Function** for a multiple linear regression model assuming normally distributed errors is:\n\n  $$\n  \\ln(L) = -\\frac{n}{2} \\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n (y_i - \\hat{y}_i)^2\n  $$\n\n  where  \n  - $n$ is the number of observations,  \n  - $\\sigma^2$ is the variance of the error term,  \n  - $\\hat{y}_i$ is the predicted value of $y_i$.\n\n  The **Akaike Information Criterion (AIC)** and **Bayesian Information Criterion (BIC)** are defined as:\n\n  $$\n  \\text{AIC} = 2k - 2\\ln(\\hat{L})\n  $$\n  \n  $$\n  \\text{BIC} = k\\ln(n) - 2\\ln(\\hat{L})\n  $$\n  \n  where  \n  - $k$ is the number of parameters in the model,  \n  - $\\ln(\\hat{L})$ is the maximized value of the log likelihood function for the model,  \n  - $n$ is the sample size.\n\n**Use Cases:**\n  \n  - **AIC** is generally preferred when the primary goal is to selecting a structural model. It balances model fit with complexity but imposes a lighter penalty for additional parameters, making it suitable for scenarios where overfitting is less of a concern than omited variable bias.\n  \n  - **BIC** is often favored when the goal is prediction. It imposes a heavier penalty for additional parameters, which can be advantageous in avoiding overfitting and selecting simpler models.\n  \n  - **Comparing Models**: When comparing models that predict the same outcome variable, a difference of about 2â€“7 points in AIC or BIC indicates moderate evidence in favor of the model with the lower score.\n\n*Practical Tips*\n\n  - Do not rely solely on p-values. Incorporate theoretical considerations, domain expertise, and additional metrics such as adjusted R-squared, AIC, or BIC.\n  \n  - Check diagnostics. Even models that look good on paper can fail if they violate OLS assumptions such as linearity or homoscedasticity.\n  \n  - Aim for parsimony. Strive for a balance between simplicity and explanatory power to avoid overfitting and to keep the model interpretable.\n\n## Case Study\n\nWe will perform a multiple regression analysis using the `mtcars` dataset to predict `mpg` based on all other variables. The steps include loading the data, estimating the model, selecting the best model using AIC and BIC, and visualizing the residuals.\n\n**Step 1: Load Data**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\npacman::p_load(olsrr, ggplot2)\n\n# Load the mtcars dataset\ndata(mtcars)\n```\n:::\n\n\n\n**Step 2: Estimate the Full Model**\n\nEstimate a multiple linear regression model with `mpg` as the dependent variable and all other variables as independent variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the full multiple linear regression model\nfull_model <- lm(mpg ~ ., data = mtcars)\n\n# View the summary of the full model\nsummary(full_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ ., data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.4506 -1.6044 -0.1196  1.2193  4.6271 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept) 12.30337   18.71788   0.657   0.5181  \ncyl         -0.11144    1.04502  -0.107   0.9161  \ndisp         0.01334    0.01786   0.747   0.4635  \nhp          -0.02148    0.02177  -0.987   0.3350  \ndrat         0.78711    1.63537   0.481   0.6353  \nwt          -3.71530    1.89441  -1.961   0.0633 .\nqsec         0.82104    0.73084   1.123   0.2739  \nvs           0.31776    2.10451   0.151   0.8814  \nam           2.52023    2.05665   1.225   0.2340  \ngear         0.65541    1.49326   0.439   0.6652  \ncarb        -0.19942    0.82875  -0.241   0.8122  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.65 on 21 degrees of freedom\nMultiple R-squared:  0.869,\tAdjusted R-squared:  0.8066 \nF-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07\n```\n\n\n:::\n:::\n\n\n\n**Step 3: Model Selection Using AIC and BIC**\n\nUse the `olsrr` package to perform model selection based on AIC and BIC criteria.\n\n*AIC Model*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Forward selection based on AIC\nmodel_aic <-  ols_step_both_aic(full_model, details = FALSE)\nmodel_aic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                             Stepwise Summary                              \n-------------------------------------------------------------------------\nStep    Variable        AIC        SBC       SBIC        R2       Adj. R2 \n-------------------------------------------------------------------------\n 0      Base Model    208.756    211.687    115.061    0.00000    0.00000 \n 1      wt (+)        166.029    170.427     74.373    0.75283    0.74459 \n 2      cyl (+)       156.010    161.873     66.190    0.83023    0.81852 \n 3      hp (+)        155.477    162.805     66.696    0.84315    0.82634 \n-------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                          \n---------------------------------------------------------------\nR                       0.918       RMSE                 2.349 \nR-Squared               0.843       MSE                  5.519 \nAdj. R-Squared          0.826       Coef. Var           12.501 \nPred R-Squared          0.796       AIC                155.477 \nMAE                     1.845       SBC                162.805 \n---------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                               ANOVA                                 \n--------------------------------------------------------------------\n                Sum of                                              \n               Squares        DF    Mean Square      F         Sig. \n--------------------------------------------------------------------\nRegression     949.427         3        316.476    50.171    0.0000 \nResidual       176.621        28          6.308                     \nTotal         1126.047        31                                    \n--------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)    38.752         1.787                 21.687    0.000    35.092    42.412 \n         wt    -3.167         0.741       -0.514    -4.276    0.000    -4.684    -1.650 \n        cyl    -0.942         0.551       -0.279    -1.709    0.098    -2.070     0.187 \n         hp    -0.018         0.012       -0.205    -1.519    0.140    -0.042     0.006 \n----------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n*BIC Model*\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Backward selection based on BIC\nmodel_bic <-  ols_step_both_sbc(full_model, details = FALSE)\nmodel_bic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                             Stepwise Summary                              \n-------------------------------------------------------------------------\nStep    Variable        AIC        SBC       SBIC        R2       Adj. R2 \n-------------------------------------------------------------------------\n 0      Base Model    208.756    211.687    115.061    0.00000    0.00000 \n 1      wt (+)        166.029    170.427     74.373    0.75283    0.74459 \n 2      cyl (+)       156.010    161.873     66.190    0.83023    0.81852 \n-------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                          \n---------------------------------------------------------------\nR                       0.911       RMSE                 2.444 \nR-Squared               0.830       MSE                  5.974 \nAdj. R-Squared          0.819       Coef. Var           12.780 \nPred R-Squared          0.790       AIC                156.010 \nMAE                     1.921       SBC                161.873 \n---------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                               ANOVA                                 \n--------------------------------------------------------------------\n                Sum of                                              \n               Squares        DF    Mean Square      F         Sig. \n--------------------------------------------------------------------\nRegression     934.875         2        467.438    70.908    0.0000 \nResidual       191.172        29          6.592                     \nTotal         1126.047        31                                    \n--------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)    39.686         1.715                 23.141    0.000    36.179    43.194 \n         wt    -3.191         0.757       -0.518    -4.216    0.000    -4.739    -1.643 \n        cyl    -1.508         0.415       -0.447    -3.636    0.001    -2.356    -0.660 \n----------------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n*Explanation:*\n\n- **AIC (Akaike Information Criterion)**: Balances model fit with complexity. Lower AIC indicates a better model.\n- **BIC (Bayesian Information Criterion)**: Similar to AIC but imposes a heavier penalty for additional parameters, favoring simpler models. Lower BIC indicates a better model.\n\nBy comparing AIC and BIC, we can select a model that adequately fits the data without unnecessary complexity.\n\n\n\n**Step 4: Residuals vs. Fitted Plot**\n\nPlot the residuals versus fitted values to assess the assumptions of linearity and homoscedasticity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot Residuals vs Fitted for the selected model (AIC)\nggplot(model_aic$model, aes(x = fitted(model_aic$model), y = resid(model_aic$model))) +\n  geom_point(color = \"blue\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\") +\n  labs(title = \"Residuals vs Fitted (AIC Selected Model)\",\n       x = \"Fitted Values\",\n       y = \"Residuals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Lecture_M01-L05_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n**Step 5: Plot Histograms of Residuals**\n\nVisualize the distribution of residuals to assess normality.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram of Residuals for the selected model (AIC)\nggplot(model_aic$model, aes(x = resid(model_aic$model))) +\n  geom_histogram(binwidth = 1, fill = \"skyblue\", color = \"black\") +\n  labs(title = \"Histogram of Residuals (AIC Selected Model)\",\n       x = \"Residuals\",\n       y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Lecture_M01-L05_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n## Conclusion\n\n- Takeaway 1: Multiple linear regression captures more complex relationships by including additional predictors, reducing omitted variable bias.\n- Takeaway 2: Coefficients in multiple regression represent partial effects, showing how the dependent variable changes with one predictor while controlling for others.\n- Takeaway 3: Model selection and fit criteria (like AIC, BIC, and stepwise methods) can guide which predictors to include, but practical judgment and theoretical considerations remain essential.\n\n\n\n",
    "supporting": [
      "Lecture_M01-L05_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"Lecture_M01-L05_files/libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"Lecture_M01-L05_files/libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"Lecture_M01-L05_files/libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"Lecture_M01-L05_files/libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"Lecture_M01-L05_files/libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"Lecture_M01-L05_files/libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"Lecture_M01-L05_files/libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"Lecture_M01-L05_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"Lecture_M01-L05_files/libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}